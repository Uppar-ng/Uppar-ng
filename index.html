<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Vault | Secure Password Manager</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --primary-light: #dbeafe;
            --secondary: #7c3aed;
            --background: #ffffff;
            --card: #f8fafc;
            --surface: #ffffff;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --text-tertiary: #94a3b8;
            --border: #e2e8f0;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #3b82f6;
            --elevation: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --elevation-high: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --radius: 12px;
            --radius-lg: 16px;
            --radius-xl: 20px;
            --spacing-xs: 8px;
            --spacing-sm: 12px;
            --spacing-md: 16px;
            --spacing-lg: 24px;
            --spacing-xl: 32px;
            --spacing-2xl: 48px;
        }

        [data-theme="dark"] {
            --primary: #3b82f6;
            --primary-dark: #2563eb;
            --primary-light: #1e3a8a;
            --secondary: #8b5cf6;
            --background: #0f172a;
            --card: #1e293b;
            --surface: #1e293b;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --text-tertiary: #64748b;
            --border: #334155;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #3b82f6;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Inter', sans-serif;
        }

        body {
            background-color: var(--background);
            color: var(--text-primary);
            line-height: 1.5;
            overflow-x: hidden;
            height: 100vh;
        }

        .app {
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Auth Screen */
        .auth-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .auth-container {
            background-color: var(--surface);
            border-radius: var(--radius-xl);
            padding: var(--spacing-xl);
            width: 100%;
            max-width: 400px;
            box-shadow: var(--elevation-high);
            color: var(--text-primary);
            animation: slideUp 0.4s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .auth-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            text-align: center;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .auth-subtitle {
            font-size: 16px;
            color: var(--text-secondary);
            margin-bottom: var(--spacing-lg);
            text-align: center;
        }

        .pin-container {
            display: flex;
            justify-content: center;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-lg);
        }

        .pin-input {
            width: 56px;
            height: 64px;
            border: 2px solid var(--border);
            border-radius: var(--radius);
            font-size: 24px;
            text-align: center;
            background-color: var(--background);
            color: var(--text-primary);
            transition: all 0.2s;
            font-weight: 600;
        }

        .pin-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
            transform: translateY(-2px);
        }

        .pin-input.filled {
            border-color: var(--primary);
            background-color: var(--primary-light);
        }

        .auth-message {
            text-align: center;
            margin-bottom: var(--spacing-md);
            min-height: 20px;
            font-size: 14px;
            padding: var(--spacing-sm);
            border-radius: var(--radius);
        }

        .auth-message.error {
            color: var(--danger);
            background-color: rgba(239, 68, 68, 0.1);
        }

        .auth-message.success {
            color: var(--success);
            background-color: rgba(16, 185, 129, 0.1);
        }

        /* Main App */
        .main-app {
            display: none;
            height: 100vh;
            flex-direction: column;
        }

        /* Header */
        .header {
            background-color: var(--surface);
            border-bottom: 1px solid var(--border);
            padding: var(--spacing-md);
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
            background-color: rgba(255, 255, 255, 0.8);
        }

        [data-theme="dark"] .header {
            background-color: rgba(30, 41, 59, 0.8);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-title {
            font-size: 24px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .header-title i {
            color: var(--primary);
        }

        .header-actions {
            display: flex;
            gap: var(--spacing-sm);
        }

        /* Icon Button */
        .icon-button {
            width: 44px;
            height: 44px;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--card);
            border: 1px solid var(--border);
            color: var(--text-primary);
            font-size: 18px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .icon-button:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: var(--elevation);
        }

        /* Search Bar */
        .search-container {
            padding: var(--spacing-md);
            border-bottom: 1px solid var(--border);
            background: var(--surface);
        }

        .search-bar {
            display: flex;
            align-items: center;
            background-color: var(--card);
            border-radius: var(--radius);
            padding: var(--spacing-sm) var(--spacing-md);
            gap: var(--spacing-sm);
            border: 1px solid var(--border);
            transition: all 0.2s;
        }

        .search-bar:focus-within {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .search-icon {
            color: var(--text-tertiary);
        }

        .search-input {
            flex: 1;
            border: none;
            background: none;
            color: var(--text-primary);
            font-size: 16px;
            outline: none;
        }

        .search-input::placeholder {
            color: var(--text-tertiary);
        }

        /* Main Content */
        .content {
            flex: 1;
            overflow-y: auto;
            padding-bottom: 80px;
        }

        .page {
            display: none;
            padding: var(--spacing-md);
        }

        .page.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Cards */
        .card {
            background-color: var(--card);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
            box-shadow: var(--elevation);
            border: 1px solid var(--border);
            transition: transform 0.2s;
        }

        .card:hover {
            transform: translateY(-2px);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-md);
        }

        .card-title {
            font-size: 20px;
            font-weight: 600;
        }

        .card-subtitle {
            font-size: 16px;
            color: var(--text-secondary);
            margin-bottom: var(--spacing-md);
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
        }

        .stat-item {
            background-color: var(--surface);
            border-radius: var(--radius);
            padding: var(--spacing-md);
            display: flex;
            flex-direction: column;
            align-items: center;
            border: 1px solid var(--border);
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: var(--spacing-xs);
        }

        .stat-label {
            font-size: 14px;
            color: var(--text-secondary);
            text-align: center;
        }

        /* Password Items */
        .password-item {
            background-color: var(--surface);
            border-radius: var(--radius);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
            border: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            transition: all 0.2s;
            cursor: pointer;
        }

        .password-item:hover {
            background-color: var(--card);
            border-color: var(--primary);
            transform: translateX(4px);
        }

        .password-icon {
            width: 44px;
            height: 44px;
            border-radius: var(--radius);
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .password-content {
            flex: 1;
        }

        .password-name {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .password-username {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .password-actions {
            display: flex;
            gap: var(--spacing-xs);
        }

        .action-btn {
            width: 36px;
            height: 36px;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--card);
            border: 1px solid var(--border);
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.2s;
        }

        .action-btn:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* Buttons */
        .btn {
            padding: var(--spacing-sm) var(--spacing-lg);
            border-radius: var(--radius);
            border: none;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--elevation);
        }

        .btn-secondary {
            background-color: var(--card);
            color: var(--primary);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background-color: var(--border);
        }

        .btn-full {
            width: 100%;
        }

        /* Bottom Navigation */
        .tab-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: var(--surface);
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: space-around;
            padding: var(--spacing-sm) 0;
            z-index: 100;
            backdrop-filter: blur(10px);
            background-color: rgba(255, 255, 255, 0.9);
        }

        [data-theme="dark"] .tab-bar {
            background-color: rgba(30, 41, 59, 0.9);
        }

        .tab-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: var(--spacing-sm);
            border: none;
            background: none;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s;
            flex: 1;
            max-width: 80px;
            border-radius: var(--radius);
        }

        .tab-item:hover {
            color: var(--primary);
            background-color: var(--card);
        }

        .tab-item.active {
            color: var(--primary);
            background-color: var(--primary-light);
        }

        .tab-icon {
            font-size: 22px;
        }

        .tab-label {
            font-size: 12px;
            font-weight: 500;
        }

        /* Modals */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: var(--spacing-md);
            animation: fadeIn 0.3s ease;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background-color: var(--surface);
            border-radius: var(--radius-xl);
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--elevation-high);
            animation: slideUp 0.3s ease;
        }

        .modal-header {
            padding: var(--spacing-lg);
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            background-color: var(--surface);
            border-radius: var(--radius-xl) var(--radius-xl) 0 0;
            z-index: 1;
        }

        .modal-title {
            font-size: 22px;
            font-weight: 700;
        }

        .modal-body {
            padding: var(--spacing-lg);
        }

        .modal-footer {
            padding: var(--spacing-lg);
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: flex-end;
            gap: var(--spacing-md);
            position: sticky;
            bottom: 0;
            background-color: var(--surface);
            border-radius: 0 0 var(--radius-xl) var(--radius-xl);
        }

        /* Forms */
        .form-group {
            margin-bottom: var(--spacing-lg);
        }

        .form-label {
            display: block;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: var(--spacing-sm);
            color: var(--text-primary);
        }

        .form-control {
            width: 100%;
            padding: var(--spacing-md);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            font-size: 16px;
            background-color: var(--background);
            color: var(--text-primary);
            transition: all 0.2s;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .input-with-button {
            display: flex;
            gap: var(--spacing-md);
        }

        .input-with-button .form-control {
            flex: 1;
        }

        /* Settings */
        .settings-group {
            margin-bottom: var(--spacing-xl);
        }

        .settings-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-sm);
            border-bottom: 2px solid var(--border);
            color: var(--primary);
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-md);
            border-bottom: 1px solid var(--border);
            transition: background-color 0.2s;
        }

        .setting-item:hover {
            background-color: var(--card);
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-info {
            flex: 1;
        }

        .setting-name {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .setting-desc {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        /* Toggle Switch */
        .toggle {
            position: relative;
            width: 60px;
            height: 32px;
        }

        .toggle input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--border);
            transition: .4s;
            border-radius: 34px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 24px;
            width: 24px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        input:checked + .toggle-slider {
            background-color: var(--primary);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(28px);
        }

        /* Select */
        .select {
            padding: var(--spacing-sm) var(--spacing-md);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            background-color: var(--background);
            color: var(--text-primary);
            font-size: 16px;
            min-width: 140px;
            cursor: pointer;
        }

        .select:focus {
            outline: none;
            border-color: var(--primary);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: var(--spacing-2xl) var(--spacing-lg);
            color: var(--text-secondary);
        }

        .empty-icon {
            font-size: 64px;
            margin-bottom: var(--spacing-lg);
            opacity: 0.5;
            color: var(--primary);
        }

        .empty-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: var(--spacing-sm);
            color: var(--text-primary);
        }

        .empty-desc {
            font-size: 16px;
            margin-bottom: var(--spacing-lg);
            max-width: 300px;
            margin-left: auto;
            margin-right: auto;
        }

        /* FAB */
        .fab {
            position: fixed;
            bottom: 80px;
            right: var(--spacing-md);
            width: 56px;
            height: 56px;
            border-radius: 28px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            box-shadow: var(--elevation-high);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.2s;
            z-index: 99;
        }

        .fab:hover {
            transform: scale(1.1) rotate(90deg);
            box-shadow: 0 10px 25px rgba(37, 99, 235, 0.3);
        }

        /* Security Dashboard */
        .security-score {
            text-align: center;
            margin-bottom: var(--spacing-xl);
        }

        .score-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: conic-gradient(var(--primary) 0% 75%, var(--border) 75% 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto var(--spacing-md);
            position: relative;
        }

        .score-inner {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            background: var(--surface);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            font-weight: 700;
            color: var(--primary);
        }

        .score-grade {
            font-size: 24px;
            font-weight: 700;
            color: var(--success);
            margin-top: var(--spacing-xs);
        }

        /* Security Indicators */
        .security-indicator {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-sm);
            border-radius: var(--radius);
            margin-bottom: var(--spacing-sm);
            background: var(--surface);
            border: 1px solid var(--border);
        }

        .indicator-status {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .status-good {
            background-color: var(--success);
        }

        .status-warning {
            background-color: var(--warning);
        }

        .status-danger {
            background-color: var(--danger);
        }

        .indicator-text {
            flex: 1;
            font-size: 14px;
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--surface);
            border-radius: var(--radius);
            padding: var(--spacing-md);
            box-shadow: var(--elevation-high);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            z-index: 10000;
            animation: slideInRight 0.3s ease;
            border-left: 4px solid var(--primary);
            max-width: 400px;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .notification-icon {
            font-size: 20px;
            color: var(--primary);
        }

        .notification-content {
            flex: 1;
        }

        .notification-title {
            font-weight: 600;
            margin-bottom: 2px;
        }

        .notification-message {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .notification-close {
            background: none;
            border: none;
            color: var(--text-tertiary);
            cursor: pointer;
            padding: 4px;
        }

        /* Clipboard Clear Notification */
        .clipboard-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--success);
            color: white;
            padding: var(--spacing-sm) var(--spacing-md);
            border-radius: var(--radius);
            font-size: 14px;
            z-index: 10000;
            animation: slideInRight 0.3s ease;
        }

        /* Lock Screen */
        .lock-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            color: white;
        }

        .lock-screen.active {
            display: flex;
        }

        .lock-icon {
            font-size: 64px;
            margin-bottom: var(--spacing-lg);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .lock-message {
            font-size: 18px;
            margin-bottom: var(--spacing-lg);
            text-align: center;
            max-width: 300px;
        }

        /* Tooltips */
        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltip-text {
            visibility: hidden;
            background-color: var(--text-primary);
            color: var(--background);
            text-align: center;
            padding: var(--spacing-sm) var(--spacing-md);
            border-radius: var(--radius);
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            white-space: nowrap;
            font-size: 14px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .tooltip .tooltip-text::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: var(--text-primary) transparent transparent transparent;
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        /* Responsive */
        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .password-actions {
                flex-direction: column;
            }
            
            .auth-container {
                padding: var(--spacing-lg);
            }
        }

        /* Utility Classes */
        .hidden {
            display: none !important;
        }

        .text-center {
            text-align: center;
        }

        .mt-md {
            margin-top: var(--spacing-md);
        }

        .mb-md {
            margin-bottom: var(--spacing-md);
        }

        .ml-auto {
            margin-left: auto;
        }

        .flex {
            display: flex;
        }

        .items-center {
            align-items: center;
        }

        .justify-between {
            justify-content: space-between;
        }

        .gap-sm {
            gap: var(--spacing-sm);
        }

        .gap-md {
            gap: var(--spacing-md);
        }

        /* Animation */
        @keyframes slideIn {
            from {
                transform: translateY(-10px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
    </style>
</head>
<body>
    <!-- Auth Screen -->
    <div class="auth-screen" id="authScreen">
        <div class="auth-container">
            <h1 class="auth-title" id="authTitle">My Vault</h1>
            <p class="auth-subtitle" id="authSubtitle">Your secure password manager</p>
            
            <div class="pin-container">
                <input type="password" class="pin-input" id="pin1" maxlength="1" inputmode="numeric" autocomplete="off">
                <input type="password" class="pin-input" id="pin2" maxlength="1" inputmode="numeric" autocomplete="off">
                <input type="password" class="pin-input" id="pin3" maxlength="1" inputmode="numeric" autocomplete="off">
                <input type="password" class="pin-input" id="pin4" maxlength="1" inputmode="numeric" autocomplete="off">
            </div>
            
            <div class="auth-message" id="authMessage"></div>
            
            <button class="btn btn-primary btn-full" id="authButton">
                Continue
            </button>
        </div>
    </div>

    <!-- Lock Screen -->
    <div class="lock-screen" id="lockScreen">
        <i class="fas fa-lock lock-icon"></i>
        <div class="lock-message" id="lockMessage">Session expired. Please enter your PIN.</div>
        <div class="auth-container">
            <div class="pin-container">
                <input type="password" class="pin-input" id="lockPin1" maxlength="1" inputmode="numeric" autocomplete="off">
                <input type="password" class="pin-input" id="lockPin2" maxlength="1" inputmode="numeric" autocomplete="off">
                <input type="password" class="pin-input" id="lockPin3" maxlength="1" inputmode="numeric" autocomplete="off">
                <input type="password" class="pin-input" id="lockPin4" maxlength="1" inputmode="numeric" autocomplete="off">
            </div>
            
            <div class="auth-message" id="lockMessageText"></div>
            
            <button class="btn btn-primary btn-full" id="unlockButton">
                Unlock
            </button>
        </div>
    </div>

    <!-- Main App -->
    <div class="main-app" id="mainApp">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1 class="header-title">
                    <i class="fas fa-lock"></i>
                    <span id="headerTitle">My Vault</span>
                </h1>
                <div class="header-actions">
                    <button class="icon-button" id="themeToggle" title="Toggle theme">
                        <i class="fas fa-moon"></i>
                    </button>
                    <button class="icon-button" id="lockButton" title="Lock app">
                        <i class="fas fa-lock"></i>
                    </button>
                    <button class="icon-button" id="settingsButton" title="Settings">
                        <i class="fas fa-cog"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- Search Bar -->
        <div class="search-container" id="searchContainer">
            <div class="search-bar">
                <i class="fas fa-search search-icon"></i>
                <input type="text" class="search-input" id="searchInput" placeholder="Search passwords...">
            </div>
        </div>

        <!-- Main Content -->
        <main class="content">
            <!-- Home Page -->
            <section class="page active" id="home-page">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Security Dashboard</h2>
                        <span class="text-secondary" id="lastUpdated">Updated just now</span>
                    </div>
                    
                    <div class="security-score">
                        <div class="score-circle">
                            <div class="score-inner">
                                <span id="securityScore">85</span>%
                            </div>
                        </div>
                        <div class="score-grade" id="securityGrade">B+</div>
                        <p class="text-secondary">Overall Security Score</p>
                    </div>

                    <div class="security-indicators">
                        <div class="security-indicator">
                            <div class="indicator-status status-good"></div>
                            <div class="indicator-text">Strong passwords: <strong id="strongCount">8</strong></div>
                        </div>
                        <div class="security-indicator">
                            <div class="indicator-status status-warning"></div>
                            <div class="indicator-text">Expiring soon: <strong id="expiringCount">2</strong></div>
                        </div>
                        <div class="security-indicator">
                            <div class="indicator-status status-danger"></div>
                            <div class="indicator-text">Reused passwords: <strong id="reusedCount">1</strong></div>
                        </div>
                    </div>
                </div>

                <h3 class="card-title mt-md">Recent Passwords</h3>
                <div id="recentPasswordList">
                    <!-- Recent passwords will be dynamically added here -->
                </div>
            </section>

            <!-- Passwords Page -->
            <section class="page" id="passwords-page">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">All Passwords</h2>
                        <span class="text-secondary" id="passwordCount">0 passwords</span>
                    </div>
                </div>

                <div id="passwordList">
                    <!-- Passwords will be dynamically added here -->
                </div>

                <!-- Empty State -->
                <div class="empty-state hidden" id="emptyState">
                    <div class="empty-icon">
                        <i class="fas fa-key"></i>
                    </div>
                    <h3 class="empty-title">No passwords yet</h3>
                    <p class="empty-desc">Add your first password to get started</p>
                    <button class="btn btn-primary mt-md" id="addFirstPasswordBtn">
                        <i class="fas fa-plus"></i>
                        Add Password
                    </button>
                </div>
            </section>

            <!-- Security Page -->
            <section class="page" id="security-page">
                <div class="card">
                    <h2 class="card-title">Security Center</h2>
                    <p class="card-subtitle">Manage your security settings and view reports</p>
                    
                    <div class="settings-group">
                        <h3 class="settings-title">Security Features</h3>
                        
                        <div class="setting-item">
                            <div class="setting-info">
                                <div class="setting-name">Clipboard Auto-Clear</div>
                                <div class="setting-desc">Automatically clear copied passwords after 30 seconds</div>
                            </div>
                            <label class="toggle">
                                <input type="checkbox" id="clipboardAutoClear">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <div class="setting-name">Password Expiry Notifications</div>
                                <div class="setting-desc">Get alerts when passwords are older than 30 days</div>
                            </div>
                            <label class="toggle">
                                <input type="checkbox" id="expiryNotifications" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <div class="setting-name">Duplicate Detection</div>
                                <div class="setting-desc">Alert when using the same password for multiple accounts</div>
                            </div>
                            <label class="toggle">
                                <input type="checkbox" id="duplicateDetection" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <div class="setting-name">Session Timeout</div>
                                <div class="setting-desc">Automatically lock the app after 5 minutes of inactivity</div>
                            </div>
                            <label class="toggle">
                                <input type="checkbox" id="sessionTimeout" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <div class="setting-name">Failed Attempt Lockout</div>
                                <div class="setting-desc">Lock app after 5 failed PIN attempts for 15 minutes</div>
                            </div>
                            <label class="toggle">
                                <input type="checkbox" id="failedAttemptLockout" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <div class="setting-name">Password History</div>
                                <div class="setting-desc">Keep history of previous password versions</div>
                            </div>
                            <label class="toggle">
                                <input type="checkbox" id="passwordHistory">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>

                    <div class="settings-group">
                        <h3 class="settings-title">Security Reports</h3>
                        <button class="btn btn-secondary btn-full mb-md" id="generateReportBtn">
                            <i class="fas fa-shield-alt"></i>
                            Generate Security Report
                        </button>
                        <button class="btn btn-secondary btn-full" id="exportEncryptedBtn">
                            <i class="fas fa-file-export"></i>
                            Export Encrypted Backup
                        </button>
                    </div>
                </div>
            </section>
        </main>

        <!-- Bottom Navigation -->
        <nav class="tab-bar">
            <button class="tab-item active" data-page="home-page">
                <i class="tab-icon fas fa-home"></i>
                <span class="tab-label">Home</span>
            </button>
            <button class="tab-item" data-page="passwords-page">
                <i class="tab-icon fas fa-key"></i>
                <span class="tab-label">Passwords</span>
            </button>
            <button class="tab-item" data-page="security-page">
                <i class="tab-icon fas fa-shield-alt"></i>
                <span class="tab-label">Security</span>
            </button>
        </nav>

        <!-- FAB -->
        <button class="fab" id="addPasswordFab">
            <i class="fas fa-plus"></i>
        </button>
    </div>

    <!-- Add/Edit Password Modal -->
    <div class="modal-overlay" id="passwordModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="modalTitle">Add New Password</h3>
                <button class="icon-button" id="closeModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="passwordForm">
                    <div class="form-group">
                        <label class="form-label" for="passwordTitle">Title</label>
                        <input type="text" class="form-control" id="passwordTitle" placeholder="e.g., Gmail Account" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="passwordUsername">Username/Email</label>
                        <input type="text" class="form-control" id="passwordUsername" placeholder="username@example.com" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="passwordValue">Password</label>
                        <div class="input-with-button">
                            <input type="password" class="form-control" id="passwordValue" placeholder="Enter password" required>
                            <button type="button" class="btn btn-secondary" id="generateForFormBtn">
                                <i class="fas fa-magic"></i>
                            </button>
                        </div>
                        <div class="password-strength mt-md" id="passwordStrength">
                            <!-- Strength indicator will be added here -->
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="passwordUrl">Website URL</label>
                        <input type="url" class="form-control" id="passwordUrl" placeholder="https://example.com">
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="passwordNotes">Notes</label>
                        <textarea class="form-control" id="passwordNotes" rows="2" placeholder="Additional information"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelBtn">Cancel</button>
                <button class="btn btn-primary" id="savePasswordBtn">Save Password</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal-overlay" id="settingsModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Settings</h3>
                <button class="icon-button" id="closeSettingsModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="settings-group">
                    <h3 class="settings-title">Appearance</h3>
                    <div class="setting-item">
                        <div class="setting-info">
                            <div class="setting-name">Dark Mode</div>
                            <div class="setting-desc">Switch between light and dark themes</div>
                        </div>
                        <label class="toggle">
                            <input type="checkbox" id="darkModeToggle">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <div class="settings-group">
                    <h3 class="settings-title">Language</h3>
                    <div class="setting-item">
                        <div class="setting-info">
                            <div class="setting-name">App Language</div>
                            <div class="setting-desc">Choose your preferred language</div>
                        </div>
                        <select class="select" id="languageSelect">
                            <option value="en">English</option>
                            <option value="ha">Hausa</option>
                            <option value="ar">العربية</option>
                        </select>
                    </div>
                </div>

                <div class="settings-group">
                    <h3 class="settings-title">Auto Lock</h3>
                    <div class="setting-item">
                        <div class="setting-info">
                            <div class="setting-name">Auto Lock Timeout</div>
                            <div class="setting-desc">Automatically lock the app after inactivity</div>
                        </div>
                        <select class="select" id="autoLockSelect">
                            <option value="1">1 minute</option>
                            <option value="5">5 minutes</option>
                            <option value="10">10 minutes</option>
                            <option value="30">30 minutes</option>
                        </select>
                    </div>
                </div>

                <div class="settings-group">
                    <h3 class="settings-title">Security</h3>
                    <div class="setting-item">
                        <div class="setting-info">
                            <div class="setting-name">Change PIN</div>
                            <div class="setting-desc">Update your security PIN</div>
                        </div>
                        <button class="btn btn-secondary" id="changePinBtn">
                            Change PIN
                        </button>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <div class="setting-name">Export Data</div>
                            <div class="setting-desc">Download a backup of your passwords</div>
                        </div>
                        <button class="btn btn-secondary" id="exportBtn">
                            <i class="fas fa-download"></i>
                            Export
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Security Report Modal -->
    <div class="modal-overlay" id="reportModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Security Report</h3>
                <button class="icon-button" id="closeReportModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="security-score">
                    <div class="score-circle" id="reportScoreCircle">
                        <div class="score-inner">
                            <span id="reportScore">85</span>%
                        </div>
                    </div>
                    <div class="score-grade" id="reportGrade">B+</div>
                    <p class="text-secondary">Overall Security Score</p>
                </div>

                <div class="settings-group">
                    <h3 class="settings-title">Issues Found</h3>
                    <div id="reportIssues">
                        <!-- Issues will be dynamically added here -->
                    </div>
                </div>

                <div class="settings-group">
                    <h3 class="settings-title">Recommendations</h3>
                    <div id="reportRecommendations">
                        <!-- Recommendations will be dynamically added here -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="exportReportBtn">
                    <i class="fas fa-download"></i>
                    Export Report
                </button>
            </div>
        </div>
    </div>

    <script>
        // Enhanced My Vault with Advanced Security Features
        class MyVault {
            constructor() {
                this.passwords = this.loadPasswords();
                this.settings = this.loadSettings();
                this.userPin = this.loadPin();
                this.currentTheme = this.settings.theme || 'light';
                this.currentLanguage = this.settings.language || 'en';
                this.currentPage = 'home-page';
                this.editingPasswordId = null;
                this.isAuthenticated = false;
                this.lastActivity = Date.now();
                this.failedAttempts = 0;
                this.lockoutUntil = null;
                this.clipboardTimer = null;
                this.sessionTimer = null;
                
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.checkAuthentication();
                this.setupActivityTracking();
                this.applyTheme();
                this.updateDashboard();
            }

            // ========== AUTHENTICATION ==========
            loadPin() {
                return localStorage.getItem('myVault-pin');
            }

            savePin(pin) {
                localStorage.setItem('myVault-pin', pin);
            }

            checkAuthentication() {
                this.checkLockout();
                
                if (this.userPin) {
                    this.showLoginScreen();
                } else {
                    this.showPinCreationScreen();
                }
            }

            showPinCreationScreen() {
                document.getElementById('authScreen').style.display = 'flex';
                document.getElementById('mainApp').style.display = 'none';
                document.getElementById('authTitle').textContent = 'Create Your PIN';
                document.getElementById('authSubtitle').textContent = 'Enter a 4-digit PIN to secure your vault';
                document.getElementById('authButton').textContent = 'Create PIN';
                this.setupPinInputs('auth');
            }

            showLoginScreen() {
                document.getElementById('authScreen').style.display = 'flex';
                document.getElementById('mainApp').style.display = 'none';
                document.getElementById('authTitle').textContent = 'Welcome Back';
                document.getElementById('authSubtitle').textContent = 'Enter your PIN to continue';
                document.getElementById('authButton').textContent = 'Unlock';
                this.setupPinInputs('auth');
            }

            setupPinInputs(type) {
                const prefix = type === 'auth' ? '' : 'lock';
                const pinInputs = [
                    document.getElementById(`${prefix}pin1`),
                    document.getElementById(`${prefix}pin2`),
                    document.getElementById(`${prefix}pin3`),
                    document.getElementById(`${prefix}pin4`)
                ];

                pinInputs.forEach((input, index) => {
                    input.value = '';
                    input.classList.remove('filled');
                    
                    input.addEventListener('input', (e) => {
                        if (e.target.value) {
                            e.target.classList.add('filled');
                            if (index < pinInputs.length - 1) {
                                pinInputs[index + 1].focus();
                            }
                        } else {
                            e.target.classList.remove('filled');
                        }
                    });
                    
                    input.addEventListener('keydown', (e) => {
                        if (e.key === 'Backspace' && !e.target.value && index > 0) {
                            pinInputs[index - 1].focus();
                            pinInputs[index - 1].value = '';
                            pinInputs[index - 1].classList.remove('filled');
                        }
                    });
                });
                
                pinInputs[0].focus();
            }

            authenticate() {
                const lockoutCheck = this.checkLockout();
                if (lockoutCheck.locked) {
                    this.showMessage('authMessage', lockoutCheck.message, 'error');
                    return;
                }

                const pinInputs = document.querySelectorAll('#pin1, #pin2, #pin3, #pin4');
                const enteredPin = Array.from(pinInputs).map(input => input.value).join('');
                
                if (enteredPin.length !== 4) {
                    this.showMessage('authMessage', 'Please enter a 4-digit PIN', 'error');
                    return;
                }

                if (this.userPin) {
                    if (enteredPin === this.userPin) {
                        this.loginSuccess();
                    } else {
                        this.loginFailed();
                    }
                } else {
                    this.savePin(enteredPin);
                    this.userPin = enteredPin;
                    this.loginSuccess();
                }
            }

            loginSuccess() {
                this.isAuthenticated = true;
                this.failedAttempts = 0;
                localStorage.removeItem('failedAttempts');
                localStorage.removeItem('lockoutUntil');
                
                document.getElementById('authScreen').style.display = 'none';
                document.getElementById('mainApp').style.display = 'flex';
                document.getElementById('lockScreen').classList.remove('active');
                
                this.resetActivityTimer();
                this.renderPasswordList();
                this.updateDashboard();
                this.applySettings();
            }

            loginFailed() {
                this.failedAttempts++;
                localStorage.setItem('failedAttempts', this.failedAttempts);
                
                if (this.failedAttempts >= 5) {
                    this.setLockout();
                    const lockoutCheck = this.checkLockout();
                    this.showMessage('authMessage', lockoutCheck.message, 'error');
                } else {
                    const attemptsLeft = 5 - this.failedAttempts;
                    this.showMessage('authMessage', `Incorrect PIN. ${attemptsLeft} attempts remaining`, 'error');
                }
                
                this.setupPinInputs('auth');
            }

            // ========== SECURITY FEATURES ==========
            
            // 1. Enhanced Password Strength Meter
            analyzePassword(password) {
                const checks = {
                    length: password.length >= 12,
                    uppercase: /[A-Z]/.test(password),
                    lowercase: /[a-z]/.test(password),
                    numbers: /\d/.test(password),
                    symbols: /[^a-zA-Z0-9]/.test(password),
                    noRepeated: !/(.)\1{2,}/.test(password),
                    noSequential: !this.hasSequentialChars(password)
                };
                
                const score = Object.values(checks).filter(Boolean).length;
                const strength = score <= 3 ? 'weak' : score <= 5 ? 'medium' : 'strong';
                
                return {
                    score,
                    strength,
                    checks,
                    suggestions: this.getPasswordSuggestions(checks)
                };
            }

            getPasswordSuggestions(checks) {
                const suggestions = [];
                if (!checks.length) suggestions.push('Use at least 12 characters');
                if (!checks.uppercase) suggestions.push('Add uppercase letters');
                if (!checks.lowercase) suggestions.push('Add lowercase letters');
                if (!checks.numbers) suggestions.push('Include numbers');
                if (!checks.symbols) suggestions.push('Add special characters');
                if (!checks.noRepeated) suggestions.push('Avoid repeated characters');
                if (!checks.noSequential) suggestions.push('Avoid sequential patterns');
                return suggestions;
            }

            // 3. Failed Attempt Lockout
            checkLockout() {
                const lockoutUntil = localStorage.getItem('lockoutUntil');
                if (!lockoutUntil) return { locked: false };

                const now = Date.now();
                if (now < parseInt(lockoutUntil)) {
                    const minutesLeft = Math.ceil((parseInt(lockoutUntil) - now) / (1000 * 60));
                    return {
                        locked: true,
                        minutesLeft,
                        message: `Too many attempts. Try again in ${minutesLeft} minutes`
                    };
                }

                localStorage.removeItem('lockoutUntil');
                localStorage.removeItem('failedAttempts');
                return { locked: false };
            }

            setLockout() {
                const lockoutTime = new Date();
                lockoutTime.setMinutes(lockoutTime.getMinutes() + 15);
                this.lockoutUntil = lockoutTime.getTime();
                localStorage.setItem('lockoutUntil', this.lockoutUntil);
            }

            // 4. Inactive Session Timer
            setupActivityTracking() {
                const events = ['mousemove', 'keypress', 'click', 'scroll', 'touchstart'];
                events.forEach(event => {
                    document.addEventListener(event, () => this.resetActivityTimer());
                });
            }

            resetActivityTimer() {
                this.lastActivity = Date.now();
                if (this.sessionTimer) clearTimeout(this.sessionTimer);
                
                if (this.settings.sessionTimeout) {
                    const timeoutMinutes = parseInt(this.settings.autoLock) || 5;
                    this.sessionTimer = setTimeout(() => {
                        if (Date.now() - this.lastActivity > timeoutMinutes * 60 * 1000) {
                            this.lockApp();
                        }
                    }, timeoutMinutes * 60 * 1000);
                }
            }

            lockApp() {
                this.isAuthenticated = false;
                document.getElementById('lockScreen').classList.add('active');
                document.getElementById('mainApp').style.display = 'none';
                this.setupPinInputs('lock');
            }

            // 5. Password Expiry Notifications
            checkPasswordExpiry() {
                const thirtyDaysAgo = new Date();
                thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
                
                const expired = this.passwords.filter(p => {
                    const lastChanged = new Date(p.lastChanged || p.createdAt);
                    return lastChanged < thirtyDaysAgo;
                });

                if (expired.length > 0 && this.settings.expiryNotifications) {
                    this.showNotification(
                        'Password Expiry',
                        `You have ${expired.length} passwords older than 30 days`,
                        'warning'
                    );
                }

                return expired;
            }

            // 6. Duplicate Password Detection
            findDuplicatePasswords() {
                const passwordMap = {};
                const duplicates = [];
                
                this.passwords.forEach(p => {
                    if (passwordMap[p.password]) {
                        duplicates.push({
                            password: p.password,
                            accounts: [...passwordMap[p.password], p.title]
                        });
                    } else {
                        passwordMap[p.password] = [p.title];
                    }
                });

                if (duplicates.length > 0 && this.settings.duplicateDetection) {
                    this.showNotification(
                        'Duplicate Passwords',
                        `You're reusing ${duplicates.length} passwords`,
                        'warning'
                    );
                }

                return duplicates;
            }

            // 7. Clipboard Auto-Clear
            copyToClipboard(text, type = 'password') {
                navigator.clipboard.writeText(text)
                    .then(() => {
                        this.showNotification('Copied', `${type} copied to clipboard`, 'success');
                        
                        if (this.settings.clipboardAutoClear) {
                            this.startClipboardTimer();
                        }
                    })
                    .catch(err => {
                        console.error('Failed to copy:', err);
                        this.showNotification('Error', 'Failed to copy to clipboard', 'error');
                    });
            }

            startClipboardTimer() {
                if (this.clipboardTimer) clearTimeout(this.clipboardTimer);
                
                this.clipboardTimer = setTimeout(() => {
                    navigator.clipboard.writeText('')
                        .then(() => {
                            this.showNotification('Clipboard Cleared', 'Clipboard cleared for security', 'info');
                        })
                        .catch(err => console.error('Failed to clear clipboard:', err));
                }, 30000); // 30 seconds
            }

            // 9. Password History (Basic Implementation)
            savePasswordVersion(passwordId, oldPassword, newPassword) {
                if (!this.settings.passwordHistory) return;
                
                const history = this.getPasswordHistory(passwordId);
                const version = {
                    id: Date.now(),
                    oldPassword,
                    newPassword,
                    changedAt: new Date().toISOString()
                };
                
                history.unshift(version);
                if (history.length > 10) history.pop();
                
                localStorage.setItem(`passwordHistory_${passwordId}`, JSON.stringify(history));
            }

            getPasswordHistory(passwordId) {
                const stored = localStorage.getItem(`passwordHistory_${passwordId}`);
                return stored ? JSON.parse(stored) : [];
            }

            // 10. Export Encryption (Basic)
            encryptExport(data) {
                const jsonString = JSON.stringify(data);
                const encoded = btoa(unescape(encodeURIComponent(jsonString)));
                
                // Simple XOR encryption with PIN
                let encrypted = '';
                const pin = this.userPin || '1234';
                
                for (let i = 0; i < encoded.length; i++) {
                    const charCode = encoded.charCodeAt(i) ^ pin.charCodeAt(i % pin.length);
                    encrypted += String.fromCharCode(charCode);
                }
                
                return btoa(encrypted);
            }

            // 11. Browser Fingerprinting (Basic)
            generateFingerprint() {
                const fingerprint = {
                    screen: `${screen.width}x${screen.height}`,
                    language: navigator.language,
                    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                    platform: navigator.platform,
                    cookies: navigator.cookieEnabled,
                    localStorage: typeof localStorage !== 'undefined'
                };
                
                let hash = 0;
                const str = JSON.stringify(fingerprint);
                for (let i = 0; i < str.length; i++) {
                    hash = ((hash << 5) - hash) + str.charCodeAt(i);
                    hash |= 0;
                }
                return hash.toString(16);
            }

            // 12. Password Generation Rules
            generatePassword() {
                const length = 16;
                const charset = {
                    uppercase: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
                    lowercase: 'abcdefghijklmnopqrstuvwxyz',
                    numbers: '0123456789',
                    symbols: '!@#$%^&*()_+-=[]{}|;:,.<>?'
                };
                
                let password = '';
                let required = [
                    charset.uppercase[Math.floor(Math.random() * charset.uppercase.length)],
                    charset.lowercase[Math.floor(Math.random() * charset.lowercase.length)],
                    charset.numbers[Math.floor(Math.random() * charset.numbers.length)],
                    charset.symbols[Math.floor(Math.random() * charset.symbols.length)]
                ];
                
                password += required.join('');
                
                const allChars = charset.uppercase + charset.lowercase + charset.numbers + charset.symbols;
                for (let i = password.length; i < length; i++) {
                    password += allChars[Math.floor(Math.random() * allChars.length)];
                }
                
                // Shuffle the password
                password = password.split('').sort(() => Math.random() - 0.5).join('');
                
                return password;
            }

            // 13. Security Dashboard
            generateSecurityReport() {
                const total = this.passwords.length;
                const weak = this.passwords.filter(p => this.analyzePassword(p.password).strength === 'weak').length;
                const duplicates = this.findDuplicatePasswords();
                const expired = this.checkPasswordExpiry();
                
                let score = 100;
                score -= weak * 10;
                score -= duplicates.length * 5;
                score -= expired.length * 3;
                score = Math.max(0, Math.min(100, score));
                
                const grade = this.getSecurityGrade(score);
                
                const issues = [];
                if (weak > 0) issues.push(`${weak} weak passwords`);
                if (duplicates.length > 0) issues.push(`${duplicates.length} duplicate passwords`);
                if (expired.length > 0) issues.push(`${expired.length} expired passwords`);
                
                const recommendations = [];
                if (weak > 0) recommendations.push(`Change ${weak} weak password(s) using the generator`);
                if (duplicates.length > 0) recommendations.push(`Use unique passwords for each account`);
                if (expired.length > 0) recommendations.push(`Update ${expired.length} password(s) older than 30 days`);
                if (issues.length === 0) recommendations.push('Great job! Your passwords are secure.');
                
                return {
                    score,
                    grade,
                    issues,
                    recommendations,
                    details: {
                        total,
                        weak,
                        duplicates: duplicates.length,
                        expired: expired.length
                    }
                };
            }

            getSecurityGrade(score) {
                if (score >= 90) return 'A';
                if (score >= 80) return 'B';
                if (score >= 70) return 'C';
                if (score >= 60) return 'D';
                return 'F';
            }

            // ========== UI MANAGEMENT ==========
            showNotification(title, message, type = 'info') {
                const notification = document.createElement('div');
                notification.className = 'notification';
                notification.innerHTML = `
                    <div class="notification-icon">
                        <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'warning' ? 'exclamation-triangle' : type === 'error' ? 'times-circle' : 'info-circle'}"></i>
                    </div>
                    <div class="notification-content">
                        <div class="notification-title">${title}</div>
                        <div class="notification-message">${message}</div>
                    </div>
                    <button class="notification-close">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                
                document.body.appendChild(notification);
                
                notification.querySelector('.notification-close').addEventListener('click', () => {
                    notification.remove();
                });
                
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove();
                    }
                }, 5000);
            }

            showMessage(elementId, message, type = 'info') {
                const element = document.getElementById(elementId);
                element.textContent = message;
                element.className = 'auth-message ' + type;
            }

            // ========== DATA MANAGEMENT ==========
            loadPasswords() {
                const stored = localStorage.getItem('myVault-passwords');
                return stored ? JSON.parse(stored) : [];
            }

            savePasswords() {
                localStorage.setItem('myVault-passwords', JSON.stringify(this.passwords));
            }

            loadSettings() {
                const stored = localStorage.getItem('myVault-settings');
                if (stored) return JSON.parse(stored);
                
                return {
                    theme: 'light',
                    language: 'en',
                    autoLock: '5',
                    clipboardAutoClear: false,
                    expiryNotifications: true,
                    duplicateDetection: true,
                    sessionTimeout: true,
                    failedAttemptLockout: true,
                    passwordHistory: false
                };
            }

            saveSettings() {
                localStorage.setItem('myVault-settings', JSON.stringify(this.settings));
            }

            // ========== EVENT HANDLERS ==========
            setupEventListeners() {
                // Auth events
                document.getElementById('authButton').addEventListener('click', () => this.authenticate());
                document.getElementById('unlockButton').addEventListener('click', () => this.unlockApp());
                
                // Navigation
                document.querySelectorAll('.tab-item').forEach(item => {
                    item.addEventListener('click', () => {
                        const page = item.getAttribute('data-page');
                        this.switchPage(page);
                    });
                });

                // Buttons
                document.getElementById('themeToggle').addEventListener('click', () => this.toggleTheme());
                document.getElementById('lockButton').addEventListener('click', () => this.lockApp());
                document.getElementById('settingsButton').addEventListener('click', () => this.openSettingsModal());
                
                // Password management
                document.getElementById('addPasswordFab').addEventListener('click', () => this.openPasswordModal());
                document.getElementById('addFirstPasswordBtn').addEventListener('click', () => this.openPasswordModal());
                document.getElementById('savePasswordBtn').addEventListener('click', () => this.savePassword());
                document.getElementById('cancelBtn').addEventListener('click', () => this.closePasswordModal());
                document.getElementById('closeModal').addEventListener('click', () => this.closePasswordModal());
                
                // Generator
                document.getElementById('generateForFormBtn').addEventListener('click', () => this.generateForForm());
                
                // Settings
                document.getElementById('closeSettingsModal').addEventListener('click', () => this.closeSettingsModal());
                document.getElementById('changePinBtn').addEventListener('click', () => this.changePin());
                document.getElementById('exportBtn').addEventListener('click', () => this.exportData());
                document.getElementById('languageSelect').addEventListener('change', (e) => this.changeLanguage(e.target.value));
                document.getElementById('autoLockSelect').addEventListener('change', (e) => this.changeAutoLock(e.target.value));
                
                // Security features toggles
                document.getElementById('clipboardAutoClear').addEventListener('change', (e) => this.toggleSetting('clipboardAutoClear', e.target.checked));
                document.getElementById('expiryNotifications').addEventListener('change', (e) => this.toggleSetting('expiryNotifications', e.target.checked));
                document.getElementById('duplicateDetection').addEventListener('change', (e) => this.toggleSetting('duplicateDetection', e.target.checked));
                document.getElementById('sessionTimeout').addEventListener('change', (e) => this.toggleSetting('sessionTimeout', e.target.checked));
                document.getElementById('failedAttemptLockout').addEventListener('change', (e) => this.toggleSetting('failedAttemptLockout', e.target.checked));
                document.getElementById('passwordHistory').addEventListener('change', (e) => this.toggleSetting('passwordHistory', e.target.checked));
                
                // Security reports
                document.getElementById('generateReportBtn').addEventListener('click', () => this.showSecurityReport());
                document.getElementById('exportEncryptedBtn').addEventListener('click', () => this.exportEncryptedBackup());
                document.getElementById('closeReportModal').addEventListener('click', () => this.closeReportModal());
                document.getElementById('exportReportBtn').addEventListener('click', () => this.exportSecurityReport());
                
                // Search
                document.getElementById('searchInput').addEventListener('input', () => this.searchPasswords());
                
                // Password strength analysis
                document.getElementById('passwordValue').addEventListener('input', () => this.updatePasswordStrength());
            }

            // ========== PAGE MANAGEMENT ==========
            switchPage(pageName) {
                document.querySelectorAll('.tab-item').forEach(item => {
                    item.classList.remove('active');
                });
                document.querySelector(`.tab-item[data-page="${pageName}"]`).classList.add('active');

                document.querySelectorAll('.page').forEach(page => {
                    page.classList.remove('active');
                });
                document.getElementById(pageName).classList.add('active');

                const showSearch = pageName === 'passwords-page';
                const showFab = pageName === 'passwords-page';
                
                document.getElementById('searchContainer').style.display = showSearch ? 'block' : 'none';
                document.getElementById('addPasswordFab').style.display = showFab ? 'flex' : 'none';

                if (pageName === 'home-page') {
                    this.updateDashboard();
                }
            }

            // ========== THEME & SETTINGS ==========
            toggleTheme() {
                this.currentTheme = this.currentTheme === 'light' ? 'dark' : 'light';
                this.settings.theme = this.currentTheme;
                this.saveSettings();
                this.applyTheme();
            }

            applyTheme() {
                document.body.setAttribute('data-theme', this.currentTheme);
                document.getElementById('darkModeToggle').checked = this.currentTheme === 'dark';
                
                const themeIcon = document.getElementById('themeToggle').querySelector('i');
                themeIcon.className = this.currentTheme === 'light' ? 'fas fa-moon' : 'fas fa-sun';
            }

            applySettings() {
                // Apply all settings to UI
                document.getElementById('clipboardAutoClear').checked = this.settings.clipboardAutoClear;
                document.getElementById('expiryNotifications').checked = this.settings.expiryNotifications;
                document.getElementById('duplicateDetection').checked = this.settings.duplicateDetection;
                document.getElementById('sessionTimeout').checked = this.settings.sessionTimeout;
                document.getElementById('failedAttemptLockout').checked = this.settings.failedAttemptLockout;
                document.getElementById('passwordHistory').checked = this.settings.passwordHistory;
                document.getElementById('autoLockSelect').value = this.settings.autoLock;
                document.getElementById('languageSelect').value = this.settings.language;
            }

            toggleSetting(setting, value) {
                this.settings[setting] = value;
                this.saveSettings();
            }

            changeLanguage(lang) {
                this.settings.language = lang;
                this.saveSettings();
                // Language implementation would go here
            }

            changeAutoLock(value) {
                this.settings.autoLock = value;
                this.saveSettings();
                this.resetActivityTimer();
            }

            // ========== PASSWORD MANAGEMENT ==========
            renderPasswordList(passwordsToRender = null) {
                const passwords = passwordsToRender || this.passwords;
                const passwordList = document.getElementById('passwordList');
                const emptyState = document.getElementById('emptyState');
                const recentList = document.getElementById('recentPasswordList');

                if (passwords.length === 0) {
                    passwordList.innerHTML = '';
                    emptyState.classList.remove('hidden');
                    recentList.innerHTML = '<div class="empty-state"><p>No passwords yet</p></div>';
                    return;
                }

                emptyState.classList.add('hidden');
                passwordList.innerHTML = '';
                recentList.innerHTML = '';

                const sortedPasswords = [...passwords].sort((a, b) => 
                    new Date(b.lastUsed || b.createdAt) - new Date(a.lastUsed || a.createdAt)
                );

                // All passwords
                passwords.forEach(password => {
                    const item = this.createPasswordItem(password);
                    passwordList.appendChild(item);
                });

                // Recent passwords (first 3)
                sortedPasswords.slice(0, 3).forEach(password => {
                    const item = this.createPasswordItem(password);
                    recentList.appendChild(item);
                });

                document.getElementById('passwordCount').textContent = `${passwords.length} password${passwords.length !== 1 ? 's' : ''}`;
            }

            createPasswordItem(password) {
                const analysis = this.analyzePassword(password.password);
                const item = document.createElement('div');
                item.className = 'password-item';
                item.innerHTML = `
                    <div class="password-icon">
                        <i class="fas fa-lock"></i>
                    </div>
                    <div class="password-content">
                        <div class="password-name">${password.title}</div>
                        <div class="password-username">${password.username}</div>
                        <div class="password-strength">
                            <span class="strength-dot ${analysis.strength}"></span>
                            <span class="strength-text">${analysis.strength}</span>
                        </div>
                    </div>
                    <div class="password-actions">
                        <button class="action-btn copy-btn" data-id="${password.id}" title="Copy password">
                            <i class="fas fa-copy"></i>
                        </button>
                        <button class="action-btn edit-btn" data-id="${password.id}" title="Edit">
                            <i class="fas fa-edit"></i>
                        </button>
                    </div>
                `;

                // Add event listeners
                item.querySelector('.copy-btn').addEventListener('click', (e) => {
                    e.stopPropagation();
                    this.copyToClipboard(password.password, 'Password');
                });

                item.querySelector('.edit-btn').addEventListener('click', (e) => {
                    e.stopPropagation();
                    this.editPassword(password.id);
                });

                item.addEventListener('click', () => {
                    this.viewPassword(password.id);
                });

                return item;
            }

            openPasswordModal(passwordId = null) {
                this.editingPasswordId = passwordId;
                const modal = document.getElementById('passwordModal');
                const title = document.getElementById('modalTitle');
                
                if (passwordId) {
                    const password = this.passwords.find(p => p.id === passwordId);
                    if (password) {
                        title.textContent = 'Edit Password';
                        document.getElementById('passwordTitle').value = password.title;
                        document.getElementById('passwordUsername').value = password.username;
                        document.getElementById('passwordValue').value = password.password;
                        document.getElementById('passwordUrl').value = password.url || '';
                        document.getElementById('passwordNotes').value = password.notes || '';
                        this.updatePasswordStrength();
                    }
                } else {
                    title.textContent = 'Add New Password';
                    document.getElementById('passwordForm').reset();
                }
                
                modal.classList.add('active');
            }

            closePasswordModal() {
                document.getElementById('passwordModal').classList.remove('active');
                this.editingPasswordId = null;
            }

            savePassword() {
                const title = document.getElementById('passwordTitle').value.trim();
                const username = document.getElementById('passwordUsername').value.trim();
                const passwordValue = document.getElementById('passwordValue').value;
                const url = document.getElementById('passwordUrl').value.trim();
                const notes = document.getElementById('passwordNotes').value.trim();

                if (!title || !username || !passwordValue) {
                    this.showNotification('Error', 'Please fill in all required fields', 'error');
                    return;
                }

                const analysis = this.analyzePassword(passwordValue);
                const now = new Date().toISOString();

                if (this.editingPasswordId) {
                    // Update existing password
                    const index = this.passwords.findIndex(p => p.id === this.editingPasswordId);
                    if (index !== -1) {
                        // Save old password to history
                        if (this.settings.passwordHistory) {
                            this.savePasswordVersion(
                                this.editingPasswordId,
                                this.passwords[index].password,
                                passwordValue
                            );
                        }

                        this.passwords[index] = {
                            ...this.passwords[index],
                            title,
                            username,
                            password: passwordValue,
                            url,
                            notes,
                            strength: analysis.strength,
                            lastUsed: now,
                            lastChanged: now
                        };
                    }
                } else {
                    // Add new password
                    const newPassword = {
                        id: Date.now(),
                        title,
                        username,
                        password: passwordValue,
                        url,
                        notes,
                        strength: analysis.strength,
                        createdAt: now,
                        lastUsed: now,
                        lastChanged: now
                    };
                    this.passwords.push(newPassword);
                }

                this.savePasswords();
                this.renderPasswordList();
                this.updateDashboard();
                this.closePasswordModal();
                
                this.showNotification('Success', 'Password saved successfully', 'success');
            }

            editPassword(id) {
                this.openPasswordModal(id);
            }

            viewPassword(id) {
                const password = this.passwords.find(p => p.id === id);
                if (password) {
                    // Update last used timestamp
                    password.lastUsed = new Date().toISOString();
                    this.savePasswords();
                    
                    // Show password details (in a real app, this would be a modal)
                    this.showNotification(
                        password.title,
                        `Username: ${password.username}\nClick copy button to copy password`,
                        'info'
                    );
                }
            }

            generateForForm() {
                const password = this.generatePassword();
                document.getElementById('passwordValue').value = password;
                this.updatePasswordStrength();
            }

            updatePasswordStrength() {
                const password = document.getElementById('passwordValue').value;
                const analysis = this.analyzePassword(password);
                const container = document.getElementById('passwordStrength');
                
                container.innerHTML = `
                    <div class="security-indicator">
                        <div class="indicator-status ${analysis.strength === 'strong' ? 'status-good' : analysis.strength === 'medium' ? 'status-warning' : 'status-danger'}"></div>
                        <div class="indicator-text">
                            <strong>Strength: ${analysis.strength.toUpperCase()}</strong>
                            ${analysis.suggestions.length > 0 ? 
                                `<div class="text-secondary" style="font-size: 12px; margin-top: 4px;">
                                    ${analysis.suggestions[0]}
                                </div>` : 
                                ''
                            }
                        </div>
                    </div>
                `;
            }

            // ========== DASHBOARD ==========
            updateDashboard() {
                const report = this.generateSecurityReport();
                
                document.getElementById('securityScore').textContent = report.score;
                document.getElementById('securityGrade').textContent = report.grade;
                document.getElementById('strongCount').textContent = this.passwords.length - report.details.weak;
                document.getElementById('expiringCount').textContent = report.details.expired;
                document.getElementById('reusedCount').textContent = report.details.duplicates;
                
                document.getElementById('lastUpdated').textContent = 'Updated just now';
                
                // Update score circle
                const scoreCircle = document.querySelector('.score-circle');
                const percentage = report.score;
                scoreCircle.style.background = `conic-gradient(var(--primary) 0% ${percentage}%, var(--border) ${percentage}% 100%)`;
            }

            // ========== MODALS ==========
            openSettingsModal() {
                document.getElementById('settingsModal').classList.add('active');
            }

            closeSettingsModal() {
                document.getElementById('settingsModal').classList.remove('active');
            }

            showSecurityReport() {
                const report = this.generateSecurityReport();
                const modal = document.getElementById('reportModal');
                
                document.getElementById('reportScore').textContent = report.score;
                document.getElementById('reportGrade').textContent = report.grade;
                
                // Update score circle
                const scoreCircle = document.getElementById('reportScoreCircle');
                const percentage = report.score;
                scoreCircle.style.background = `conic-gradient(var(--primary) 0% ${percentage}%, var(--border) ${percentage}% 100%)`;
                
                // Issues
                const issuesContainer = document.getElementById('reportIssues');
                issuesContainer.innerHTML = report.issues.length > 0 ? 
                    report.issues.map(issue => `<div class="security-indicator"><div class="indicator-status status-warning"></div><div class="indicator-text">${issue}</div></div>`).join('') :
                    '<div class="security-indicator"><div class="indicator-status status-good"></div><div class="indicator-text">No security issues found</div></div>';
                
                // Recommendations
                const recommendationsContainer = document.getElementById('reportRecommendations');
                recommendationsContainer.innerHTML = report.recommendations.map(rec => 
                    `<div class="security-indicator"><div class="indicator-status status-info"></div><div class="indicator-text">${rec}</div></div>`
                ).join('');
                
                modal.classList.add('active');
            }

            closeReportModal() {
                document.getElementById('reportModal').classList.remove('active');
            }

            // ========== EXPORT ==========
            exportData() {
                const data = {
                    passwords: this.passwords,
                    settings: this.settings,
                    exportDate: new Date().toISOString(),
                    version: '1.0'
                };
                
                const dataStr = JSON.stringify(data, null, 2);
                const blob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(blob);
                
                const link = document.createElement('a');
                link.href = url;
                link.download = 'myvault-backup.json';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
                
                this.showNotification('Exported', 'Backup exported successfully', 'success');
            }

            exportEncryptedBackup() {
                const data = {
                    passwords: this.passwords,
                    settings: this.settings,
                    exportDate: new Date().toISOString(),
                    version: '1.0',
                    encrypted: true
                };
                
                const encrypted = this.encryptExport(data);
                const blob = new Blob([encrypted], {type: 'text/plain'});
                const url = URL.createObjectURL(blob);
                
                const link = document.createElement('a');
                link.href = url;
                link.download = 'myvault-encrypted.bak';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
                
                this.showNotification('Exported', 'Encrypted backup exported', 'success');
            }

            exportSecurityReport() {
                const report = this.generateSecurityReport();
                const data = {
                    securityReport: report,
                    generatedAt: new Date().toISOString(),
                    totalPasswords: this.passwords.length
                };
                
                const dataStr = JSON.stringify(data, null, 2);
                const blob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(blob);
                
                const link = document.createElement('a');
                link.href = url;
                link.download = 'security-report.json';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
                
                this.showNotification('Exported', 'Security report exported', 'success');
            }

            // ========== UTILITY FUNCTIONS ==========
            searchPasswords() {
                const query = document.getElementById('searchInput').value.toLowerCase().trim();
                
                if (!query) {
                    this.renderPasswordList();
                    return;
                }
                
                const filtered = this.passwords.filter(p => 
                    p.title.toLowerCase().includes(query) ||
                    p.username.toLowerCase().includes(query) ||
                    (p.url && p.url.toLowerCase().includes(query)) ||
                    (p.notes && p.notes.toLowerCase().includes(query))
                );
                
                this.renderPasswordList(filtered);
            }

            changePin() {
                if (confirm('Are you sure you want to change your PIN? You will need to enter the new PIN next time.')) {
                    this.userPin = null;
                    this.savePin('');
                    this.lockApp();
                }
            }

            unlockApp() {
                const pinInputs = document.querySelectorAll('#lockPin1, #lockPin2, #lockPin3, #lockPin4');
                const enteredPin = Array.from(pinInputs).map(input => input.value).join('');
                
                if (enteredPin === this.userPin) {
                    this.loginSuccess();
                } else {
                    this.showMessage('lockMessageText', 'Incorrect PIN', 'error');
                    this.setupPinInputs('lock');
                }
            }

            hasSequentialChars(str) {
                const sequences = ['123', '234', '345', '456', '567', '678', '789', '890',
                                 'abc', 'bcd', 'cde', 'def', 'efg', 'fgh', 'ghi', 'hij',
                                 'ijk', 'jkl', 'klm', 'lmn', 'mno', 'nop', 'opq', 'pqr',
                                 'qrs', 'rst', 'stu', 'tuv', 'uvw', 'vwx', 'wxy', 'xyz'];
                const lowerStr = str.toLowerCase();
                return sequences.some(seq => lowerStr.includes(seq));
            }
        }

        // Initialize the app
        document.addEventListener('DOMContentLoaded', () => {
            window.myVault = new MyVault();
        });
    </script>
</body>
</html>
